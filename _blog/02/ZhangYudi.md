---
title: "Split apply combine ..."
author: "Yudi Zhang"
topic: "02"
layout: post
root: ../../../
  ---
  
  ## Background:
  
The `plyr` package has by now been replaced by other, even faster packages, but the idea of *Split, apply, combine* is as relevant as ever.

Read the paper [The Split-Apply-Combine Strategy for Data Analysis](https://www.jstatsoft.org/article/view/v040i01) by Hadley Wickham.


Write a blog post addressing the questions: 
  
1. **Which (base R) functions do you know that support the split-apply-combine strategy? In your opinion, are these sufficient - state why or why not?**. 

  `*apply`, `*bind`, `aggregate`, `split`, `strsplit`, `seperate`, etc. Not sufficient, as mentioned in the paper, those functions are most of the times non readable, and they cannot be well connected with other functions. Somes can be replaced by others in tidyr.
  
2. **Using a dataset of your choice, show (by including the split-apply-combine command(s) in your answer) how you can use the split-apply-combine strategy for a part of the data analysis.**

  If we want to find the average dist for every speed on `cars`.
  
  
  {% highlight r %}
  # use dplyr
  cars %>% group_by(speed) %>% mutate_at(vars(dist), funs(ave_dist = mean(.)*speed))
  {% endhighlight %}
  
  
  
  {% highlight text %}
  ## # A tibble: 50 x 3
  ## # Groups:   speed [19]
  ##    speed  dist ave_dist
  ##    <dbl> <dbl>    <dbl>
  ##  1     4     2      24 
  ##  2     4    10      24 
  ##  3     7     4      91 
  ##  4     7    22      91 
  ##  5     8    16     128 
  ##  6     9    10      90 
  ##  7    10    18     260 
  ##  8    10    26     260 
  ##  9    10    34     260 
  ## 10    11    17     248.
  ## # ... with 40 more rows
  {% endhighlight %}
  
  
  
  {% highlight r %}
  # But I think aggregate cannot do this by group
  aggregate(cars$dist, by = list(cars$speed), FUN = function(x) mean(x)*cars$speed)
  {% endhighlight %}
  
  
  
  {% highlight text %}
  ##    Group.1       x.1       x.2       x.3       x.4       x.5       x.6
  ## 1        4   24.0000   24.0000   42.0000   42.0000   48.0000   54.0000
  ## 2        7   52.0000   52.0000   91.0000   91.0000  104.0000  117.0000
  ## 3        8   64.0000   64.0000  112.0000  112.0000  128.0000  144.0000
  ## 4        9   40.0000   40.0000   70.0000   70.0000   80.0000   90.0000
  ## 5       10  104.0000  104.0000  182.0000  182.0000  208.0000  234.0000
  ## 6       11   90.0000   90.0000  157.5000  157.5000  180.0000  202.5000
  ## 7       12   86.0000   86.0000  150.5000  150.5000  172.0000  193.5000
  ## 8       13  140.0000  140.0000  245.0000  245.0000  280.0000  315.0000
  ## 9       14  202.0000  202.0000  353.5000  353.5000  404.0000  454.5000
  ## 10      15  133.3333  133.3333  233.3333  233.3333  266.6667  300.0000
  ## 11      16  144.0000  144.0000  252.0000  252.0000  288.0000  324.0000
  ## 12      17  162.6667  162.6667  284.6667  284.6667  325.3333  366.0000
  ## 13      18  258.0000  258.0000  451.5000  451.5000  516.0000  580.5000
  ## 14      19  200.0000  200.0000  350.0000  350.0000  400.0000  450.0000
  ## 15      20  201.6000  201.6000  352.8000  352.8000  403.2000  453.6000
  ## 16      22  264.0000  264.0000  462.0000  462.0000  528.0000  594.0000
  ## 17      23  216.0000  216.0000  378.0000  378.0000  432.0000  486.0000
  ## 18      24  375.0000  375.0000  656.2500  656.2500  750.0000  843.7500
  ## 19      25  340.0000  340.0000  595.0000  595.0000  680.0000  765.0000
  ##          x.7       x.8       x.9      x.10      x.11      x.12      x.13
  ## 1    60.0000   60.0000   60.0000   66.0000   66.0000   72.0000   72.0000
  ## 2   130.0000  130.0000  130.0000  143.0000  143.0000  156.0000  156.0000
  ## 3   160.0000  160.0000  160.0000  176.0000  176.0000  192.0000  192.0000
  ## 4   100.0000  100.0000  100.0000  110.0000  110.0000  120.0000  120.0000
  ## 5   260.0000  260.0000  260.0000  286.0000  286.0000  312.0000  312.0000
  ## 6   225.0000  225.0000  225.0000  247.5000  247.5000  270.0000  270.0000
  ## 7   215.0000  215.0000  215.0000  236.5000  236.5000  258.0000  258.0000
  ## 8   350.0000  350.0000  350.0000  385.0000  385.0000  420.0000  420.0000
  ## 9   505.0000  505.0000  505.0000  555.5000  555.5000  606.0000  606.0000
  ## 10  333.3333  333.3333  333.3333  366.6667  366.6667  400.0000  400.0000
  ## 11  360.0000  360.0000  360.0000  396.0000  396.0000  432.0000  432.0000
  ## 12  406.6667  406.6667  406.6667  447.3333  447.3333  488.0000  488.0000
  ## 13  645.0000  645.0000  645.0000  709.5000  709.5000  774.0000  774.0000
  ## 14  500.0000  500.0000  500.0000  550.0000  550.0000  600.0000  600.0000
  ## 15  504.0000  504.0000  504.0000  554.4000  554.4000  604.8000  604.8000
  ## 16  660.0000  660.0000  660.0000  726.0000  726.0000  792.0000  792.0000
  ## 17  540.0000  540.0000  540.0000  594.0000  594.0000  648.0000  648.0000
  ## 18  937.5000  937.5000  937.5000 1031.2500 1031.2500 1125.0000 1125.0000
  ## 19  850.0000  850.0000  850.0000  935.0000  935.0000 1020.0000 1020.0000
  ##         x.14      x.15      x.16      x.17      x.18      x.19      x.20
  ## 1    72.0000   72.0000   78.0000   78.0000   78.0000   78.0000   84.0000
  ## 2   156.0000  156.0000  169.0000  169.0000  169.0000  169.0000  182.0000
  ## 3   192.0000  192.0000  208.0000  208.0000  208.0000  208.0000  224.0000
  ## 4   120.0000  120.0000  130.0000  130.0000  130.0000  130.0000  140.0000
  ## 5   312.0000  312.0000  338.0000  338.0000  338.0000  338.0000  364.0000
  ## 6   270.0000  270.0000  292.5000  292.5000  292.5000  292.5000  315.0000
  ## 7   258.0000  258.0000  279.5000  279.5000  279.5000  279.5000  301.0000
  ## 8   420.0000  420.0000  455.0000  455.0000  455.0000  455.0000  490.0000
  ## 9   606.0000  606.0000  656.5000  656.5000  656.5000  656.5000  707.0000
  ## 10  400.0000  400.0000  433.3333  433.3333  433.3333  433.3333  466.6667
  ## 11  432.0000  432.0000  468.0000  468.0000  468.0000  468.0000  504.0000
  ## 12  488.0000  488.0000  528.6667  528.6667  528.6667  528.6667  569.3333
  ## 13  774.0000  774.0000  838.5000  838.5000  838.5000  838.5000  903.0000
  ## 14  600.0000  600.0000  650.0000  650.0000  650.0000  650.0000  700.0000
  ## 15  604.8000  604.8000  655.2000  655.2000  655.2000  655.2000  705.6000
  ## 16  792.0000  792.0000  858.0000  858.0000  858.0000  858.0000  924.0000
  ## 17  648.0000  648.0000  702.0000  702.0000  702.0000  702.0000  756.0000
  ## 18 1125.0000 1125.0000 1218.7500 1218.7500 1218.7500 1218.7500 1312.5000
  ## 19 1020.0000 1020.0000 1105.0000 1105.0000 1105.0000 1105.0000 1190.0000
  ##         x.21      x.22      x.23      x.24      x.25      x.26      x.27
  ## 1    84.0000   84.0000   84.0000   90.0000   90.0000   90.0000   96.0000
  ## 2   182.0000  182.0000  182.0000  195.0000  195.0000  195.0000  208.0000
  ## 3   224.0000  224.0000  224.0000  240.0000  240.0000  240.0000  256.0000
  ## 4   140.0000  140.0000  140.0000  150.0000  150.0000  150.0000  160.0000
  ## 5   364.0000  364.0000  364.0000  390.0000  390.0000  390.0000  416.0000
  ## 6   315.0000  315.0000  315.0000  337.5000  337.5000  337.5000  360.0000
  ## 7   301.0000  301.0000  301.0000  322.5000  322.5000  322.5000  344.0000
  ## 8   490.0000  490.0000  490.0000  525.0000  525.0000  525.0000  560.0000
  ## 9   707.0000  707.0000  707.0000  757.5000  757.5000  757.5000  808.0000
  ## 10  466.6667  466.6667  466.6667  500.0000  500.0000  500.0000  533.3333
  ## 11  504.0000  504.0000  504.0000  540.0000  540.0000  540.0000  576.0000
  ## 12  569.3333  569.3333  569.3333  610.0000  610.0000  610.0000  650.6667
  ## 13  903.0000  903.0000  903.0000  967.5000  967.5000  967.5000 1032.0000
  ## 14  700.0000  700.0000  700.0000  750.0000  750.0000  750.0000  800.0000
  ## 15  705.6000  705.6000  705.6000  756.0000  756.0000  756.0000  806.4000
  ## 16  924.0000  924.0000  924.0000  990.0000  990.0000  990.0000 1056.0000
  ## 17  756.0000  756.0000  756.0000  810.0000  810.0000  810.0000  864.0000
  ## 18 1312.5000 1312.5000 1312.5000 1406.2500 1406.2500 1406.2500 1500.0000
  ## 19 1190.0000 1190.0000 1190.0000 1275.0000 1275.0000 1275.0000 1360.0000
  ##         x.28      x.29      x.30      x.31      x.32      x.33      x.34
  ## 1    96.0000  102.0000  102.0000  102.0000  108.0000  108.0000  108.0000
  ## 2   208.0000  221.0000  221.0000  221.0000  234.0000  234.0000  234.0000
  ## 3   256.0000  272.0000  272.0000  272.0000  288.0000  288.0000  288.0000
  ## 4   160.0000  170.0000  170.0000  170.0000  180.0000  180.0000  180.0000
  ## 5   416.0000  442.0000  442.0000  442.0000  468.0000  468.0000  468.0000
  ## 6   360.0000  382.5000  382.5000  382.5000  405.0000  405.0000  405.0000
  ## 7   344.0000  365.5000  365.5000  365.5000  387.0000  387.0000  387.0000
  ## 8   560.0000  595.0000  595.0000  595.0000  630.0000  630.0000  630.0000
  ## 9   808.0000  858.5000  858.5000  858.5000  909.0000  909.0000  909.0000
  ## 10  533.3333  566.6667  566.6667  566.6667  600.0000  600.0000  600.0000
  ## 11  576.0000  612.0000  612.0000  612.0000  648.0000  648.0000  648.0000
  ## 12  650.6667  691.3333  691.3333  691.3333  732.0000  732.0000  732.0000
  ## 13 1032.0000 1096.5000 1096.5000 1096.5000 1161.0000 1161.0000 1161.0000
  ## 14  800.0000  850.0000  850.0000  850.0000  900.0000  900.0000  900.0000
  ## 15  806.4000  856.8000  856.8000  856.8000  907.2000  907.2000  907.2000
  ## 16 1056.0000 1122.0000 1122.0000 1122.0000 1188.0000 1188.0000 1188.0000
  ## 17  864.0000  918.0000  918.0000  918.0000  972.0000  972.0000  972.0000
  ## 18 1500.0000 1593.7500 1593.7500 1593.7500 1687.5000 1687.5000 1687.5000
  ## 19 1360.0000 1445.0000 1445.0000 1445.0000 1530.0000 1530.0000 1530.0000
  ##         x.35      x.36      x.37      x.38      x.39      x.40      x.41
  ## 1   108.0000  114.0000  114.0000  114.0000  120.0000  120.0000  120.0000
  ## 2   234.0000  247.0000  247.0000  247.0000  260.0000  260.0000  260.0000
  ## 3   288.0000  304.0000  304.0000  304.0000  320.0000  320.0000  320.0000
  ## 4   180.0000  190.0000  190.0000  190.0000  200.0000  200.0000  200.0000
  ## 5   468.0000  494.0000  494.0000  494.0000  520.0000  520.0000  520.0000
  ## 6   405.0000  427.5000  427.5000  427.5000  450.0000  450.0000  450.0000
  ## 7   387.0000  408.5000  408.5000  408.5000  430.0000  430.0000  430.0000
  ## 8   630.0000  665.0000  665.0000  665.0000  700.0000  700.0000  700.0000
  ## 9   909.0000  959.5000  959.5000  959.5000 1010.0000 1010.0000 1010.0000
  ## 10  600.0000  633.3333  633.3333  633.3333  666.6667  666.6667  666.6667
  ## 11  648.0000  684.0000  684.0000  684.0000  720.0000  720.0000  720.0000
  ## 12  732.0000  772.6667  772.6667  772.6667  813.3333  813.3333  813.3333
  ## 13 1161.0000 1225.5000 1225.5000 1225.5000 1290.0000 1290.0000 1290.0000
  ## 14  900.0000  950.0000  950.0000  950.0000 1000.0000 1000.0000 1000.0000
  ## 15  907.2000  957.6000  957.6000  957.6000 1008.0000 1008.0000 1008.0000
  ## 16 1188.0000 1254.0000 1254.0000 1254.0000 1320.0000 1320.0000 1320.0000
  ## 17  972.0000 1026.0000 1026.0000 1026.0000 1080.0000 1080.0000 1080.0000
  ## 18 1687.5000 1781.2500 1781.2500 1781.2500 1875.0000 1875.0000 1875.0000
  ## 19 1530.0000 1615.0000 1615.0000 1615.0000 1700.0000 1700.0000 1700.0000
  ##         x.42      x.43      x.44      x.45      x.46      x.47      x.48
  ## 1   120.0000  120.0000  132.0000  138.0000  144.0000  144.0000  144.0000
  ## 2   260.0000  260.0000  286.0000  299.0000  312.0000  312.0000  312.0000
  ## 3   320.0000  320.0000  352.0000  368.0000  384.0000  384.0000  384.0000
  ## 4   200.0000  200.0000  220.0000  230.0000  240.0000  240.0000  240.0000
  ## 5   520.0000  520.0000  572.0000  598.0000  624.0000  624.0000  624.0000
  ## 6   450.0000  450.0000  495.0000  517.5000  540.0000  540.0000  540.0000
  ## 7   430.0000  430.0000  473.0000  494.5000  516.0000  516.0000  516.0000
  ## 8   700.0000  700.0000  770.0000  805.0000  840.0000  840.0000  840.0000
  ## 9  1010.0000 1010.0000 1111.0000 1161.5000 1212.0000 1212.0000 1212.0000
  ## 10  666.6667  666.6667  733.3333  766.6667  800.0000  800.0000  800.0000
  ## 11  720.0000  720.0000  792.0000  828.0000  864.0000  864.0000  864.0000
  ## 12  813.3333  813.3333  894.6667  935.3333  976.0000  976.0000  976.0000
  ## 13 1290.0000 1290.0000 1419.0000 1483.5000 1548.0000 1548.0000 1548.0000
  ## 14 1000.0000 1000.0000 1100.0000 1150.0000 1200.0000 1200.0000 1200.0000
  ## 15 1008.0000 1008.0000 1108.8000 1159.2000 1209.6000 1209.6000 1209.6000
  ## 16 1320.0000 1320.0000 1452.0000 1518.0000 1584.0000 1584.0000 1584.0000
  ## 17 1080.0000 1080.0000 1188.0000 1242.0000 1296.0000 1296.0000 1296.0000
  ## 18 1875.0000 1875.0000 2062.5000 2156.2500 2250.0000 2250.0000 2250.0000
  ## 19 1700.0000 1700.0000 1870.0000 1955.0000 2040.0000 2040.0000 2040.0000
  ##         x.49      x.50
  ## 1   144.0000  150.0000
  ## 2   312.0000  325.0000
  ## 3   384.0000  400.0000
  ## 4   240.0000  250.0000
  ## 5   624.0000  650.0000
  ## 6   540.0000  562.5000
  ## 7   516.0000  537.5000
  ## 8   840.0000  875.0000
  ## 9  1212.0000 1262.5000
  ## 10  800.0000  833.3333
  ## 11  864.0000  900.0000
  ## 12  976.0000 1016.6667
  ## 13 1548.0000 1612.5000
  ## 14 1200.0000 1250.0000
  ## 15 1209.6000 1260.0000
  ## 16 1584.0000 1650.0000
  ## 17 1296.0000 1350.0000
  ## 18 2250.0000 2343.7500
  ## 19 2040.0000 2125.0000
  {% endhighlight %}
